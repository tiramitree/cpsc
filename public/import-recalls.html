<!-- import-recalls.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Import Recall</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
  <script>
    function validateForm() {
      const fields = ["Recall_ID", "Recall_Number", "Recall_Date", "Product_Name", "Product_Type", "Category", "Priority_Status", "URL"];
      let valid = true;
      for (let id of fields) {
        if (!document.getElementById(id).value.trim()) {
          valid = false;
          break;
        }
      }
      const date = new Date(document.getElementById("Recall_Date").value);
      if (date > new Date()) valid = false;
      document.getElementById("submitBtn").disabled = !valid;
    }

    async function handleSubmit(e) {
      e.preventDefault();
      const data = {
        Recall_ID: document.getElementById("Recall_ID").value,
        Recall_Number: document.getElementById("Recall_Number").value,
        Recall_Date: document.getElementById("Recall_Date").value,
        Product_Name: document.getElementById("Product_Name").value,
        Product_Type: document.getElementById("Product_Type").value,
        Category: document.getElementById("Category").value,
        Priority_Status: document.getElementById("Priority_Status").value,
        URL: document.getElementById("URL").value,
      };

      const res = await fetch("/api/import", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data),
      });

      if (res.ok) {
        alert("Recall imported successfully");
        window.location.href = "recalls.html";
      } else {
        const err = await res.json();
        alert("Error: " + err.error);
      }
    }
  </script>
</head>
<body class="container mt-5">
  <h2>Import Recall</h2>
  <form onsubmit="handleSubmit(event)" oninput="validateForm()">
    <input class="form-control mb-2" type="text" id="Recall_ID" placeholder="Recall ID" required />
    <input class="form-control mb-2" type="text" id="Recall_Number" placeholder="Recall Number" required />
    <input class="form-control mb-2" type="date" id="Recall_Date" required />
    <input class="form-control mb-2" type="text" id="Product_Name" placeholder="Product Name" required />
    <input class="form-control mb-2" type="text" id="Product_Type" placeholder="Product Type" required />
    <input class="form-control mb-2" type="text" id="Category" placeholder="Category" required />
    <select class="form-select mb-2" id="Priority_Status" required>
      <option value="">Select Priority</option>
      <option value="High">High</option>
      <option value="Medium">Medium</option>
      <option value="Low">Low</option>
    </select>
    <input class="form-control mb-2" type="url" id="URL" placeholder="URL" required />
    <button class="btn btn-primary" type="submit" id="submitBtn" disabled>Submit</button>
  </form>
</body>
</html>
